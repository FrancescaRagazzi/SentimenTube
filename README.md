

- download the file https://dlcdn.apache.org/spark/spark-3.4.1/spark-3.4.1-bin-hadoop3.tgz in
- extract the archive and put it in spark/setup/
- docker network create tap -d bridge --subnet=10.0.100.0/24
- docker-compose up --build







- Comandi manuali da rimuovere

docker network create tap -d bridge --subnet=10.0.100.0/24
docker-compose up 
docker run --rm -it --network tap --ip 10.0.100.26  -v ./pipeline/:/usr/share/logstash/pipeline/ logstash-custom:latest
docker run --rm --network tap -v "$PWD/.ivy2:/root/.ivy2" -e SPARK_ACTION=spark-submit-python -it spark:latest sentiment_nuovo.py org.apache.spark:spark-sql-kafka-0-10_2.12:3.4.1,com.johnsnowlabs.nlp:spark-nlp_2.12:5.0.0,org.elasticsearch:elasticsearch-spark-30_2.12:8.2.0
docker run -it --rm  --network tap video_extract:latest



//elasticsearch
docker run --rm -it --network tap --ip 10.0.100.27 --name elasticsearch-node1  -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e "xpack.security.enabled=false" -e "xpack.security.enrollment.enabled=false" docker.elastic.co/elasticsearch/elasticsearch:8.8.2

//kibana
docker run --rm -it --network tap --ip 10.0.100.28 --name kibana -p 5601:5601 -e "xpack.security.enabled=false" kibana:latest



//temp spark
docker run --rm --network tap -v "$PWD/.ivy2:/root/.ivy2" -e SPARK_ACTION=spark-submit-python -it spark:latest sentiment_nuovo.py org.apache.spark:spark-sql-kafka-0-10_2.12:3.4.1,com.johnsnowlabs.nlp:spark-nlp_2.12:5.0.0,org.elasticsearch:elasticsearch-spark-30_2.12:8.2.0



Trovare un modo per pushare manualmente su kafka. Attualmente sto utilizzando il file sentiment_nuovo. Il file sentiment contiene solo la parte di kafka senza elastic.


bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic videos --from-beginning


./bin/kafka-console-producer --bootstrap-server localhost:9092 --topic videos
{"title":"STOP COPYING ME!!","comments":["Ian and Anthony‚Äôs comedic chemistry is still 2nd to none üíØ","This is what you call good classic YouTube content right here. No begging for subs, no cringy behavior, just two bros turning on the camera and having a fun time.","This feels so surreal. It'\''s like I'\''m watching a video from years ago, but it was made so recently. Absolutely crazy how consistent their comedy was retained, while STILL being humorous in this present time.","What a perfect way to celebrate the 10th anniversary of one of their best videos. The humor is still as on point as ever. The kings are truly back together and better than ever.","This shows that Ian & Anthony still got it! Brought a man tear to my eyeüò¢","The original was the greatest video back in the day. <br><br>Update: DID IT JUSTICE üî•üî•","I honestly wasn'\''t sure if I would still find this kind of comedy funny after all this time but GOD DAMMIT üò≠ They'\''ll always know how to do it","Even after Anthony came back, Shayne and Courtney still manage to make their way into every Smosh video. And hey, I'\''m not even mad about that.","I love the return of classic Smosh. Ian and Anthony still got that chemistry even after all this time.","Y'\''all STILL got it after all these years! üòÇ Not Courtney and Shayne cameoing with their own chemistry for the 911 operators bit!!üòÇ‚ù§","11 years later and I'\''m back to watching Smosh sketches, feels good üòå","Now THAT is how you \"yes and\" a classic Smosh bit.","Classic Smosh! Nothings changed from these two and I'\''m all for it! üòÇ Lets goooo!","This is seriously as impressive as it was ten years ago.<br><br>I grew up watching you both and I love to see this. üò¢‚ù§","God these new Smosh videos are so amazing, it feels like I‚Äôm a kid watching the old skits again","The comedy and writing is so much tighter than a decade ago! Can really see the growth from both of them","They were really giving their all at the end. The eye brows after ‚ÄúI‚Äôll just never say anything ever again,‚Äù was a masterful take as well. üëèüèºüëèüèº","That was awesome! Loving the classic Smosh content! Keep it up guys! :D","Couldnt stop smiling. Feels like a piece of my childhood is back seeing these style videos from you guys again","<a href=\"https://www.youtube.com/watch?v=QgPX_NE1it8&amp;t=0m33s\">0:33</a> the titanium balls for them to say that joke is absolutely phenomenal, also meaning old smosh is truly back"],"comment_count":"14787","@version":"1","channel_title":"Smosh","@timestamp":"2023-07-15T17:25:46.323542928Z","video_id":"QgPX_NE1it8","like_count":"364169","view_count":"2085793","dislike_count":0}
"{\"video_id\":\"8FDKPMtcZ68\",\"like_count\":\"203915\",\"@timestamp\":\"2023-07-17T08:43:10.354808758Z\",\"@version\":\"1\",\"view_count\":\"2216821\",\"dislike_count\":0,\"channel_title\":\"Jaiden Animations\",\"title\":\"The Time Psychics Read my Future\",\"comments\":[\"Any psychic that tells you to take your pets to the vet instead of trying to sell you some spirit protection nonsense is a psychic I respect.\",\"Here me out. The psychics saying Jaiden will have 3 kids is foreshadowing her getting a third birb\",\"The whole &quot; you will have 3 kids and live past 80&quot; definitely feels like a script read for someone Jaiden&#39;s gender and age. Either that or they really were psychics.\",\"Wait theory: If all the physics were right about Jaiden having 3 kids but she hates kids, what if they interpreted the wrong thing? What if Jaiden eventually starts calling her birds her babies and maybe gets another pet one day? A lot of people call their pets their babies so it would make sense for the mixup. Jaiden already has 2 birds so what if she gets a 3rd pet to make the fortune come true?\",\"As a reminder, some people consider their pets to be their children! It could mean that at some point Jaiden will get a third bird!\",\"I appreciate Jaiden&#39;s approach to all this.\",\"you could tell psychic 2 was doing it out of pure hobby &amp; passion. a cozy little psychic room in the closet &amp; telling you to go to the vet instead. i love her already.\",\"I appreciate Jaiden&#39;s approach to all this. Despite how weird the experiences must have been, she seems to take it in stride and as respectably as possible.\",\"I‚Äôm so happy to see another story time from Jaiden. I really missed them\",\"I love how Jaiden has upgraded from trying different apples to trying different psychics\",\"it&#39;s good to know how those people get others into their loop. My best friend has the &quot;third eye&quot; apparently and to be honest i don&#39;t believe in psychic and all, but ONCE i lost my cat and she did a reading with all her material...she told me my cat was okay, but she was lost and wouldn&#39;t be found for a long time, like a few years, but that we will see each other again. I took that as her way to comfort me and give me hope and went on with my life. 7 years laters we got a call from an association, they found back our cat, and she is now back home with us. So now every time she tries to guess thing with her third eye, i don&#39;t always believe it but i keep it in the back of my mind and prepare just in case xD<br>Anyways awesome videos with awesome animation as always :) As for the 3 kids xD maybe they&#39;re talking about animals? After all press says we millenial treat our pets like babies :v\",\"The expressions on Jaiden&#39;s face while she was attempting to deal with the 5th psychic were immaculate, well done animation team üòÇ\",\"Takeaways:<br>1. She already has 2 kids (her birds) so maybe having 3 kids means she will get another bird<br>2. Jacob Alpharad is definitely a bearded man who could give Jaiden a business opportunity\",\"Happy to find out Maya Fey is still doing great as a psycic and has Nick working for her. You go girl!\",\"It is SO funny to me that they all predicted kids, a thing Jaiden has no interest in, and then Bobby. Rest in peace sweet egg child. You plus the two birds equals They Were Right\",\"I used to get the best tarot readings of my life for $25 for thirty minutes at a local metaphysical store, didn‚Äôt make me buy a damn thing, would just give me general advice on ‚Äúif you WANTED to get something for this, this stone or this candle may help, but ultimately those are only tools and you can do it yourself‚Äù And the readings were always spot on, offered classes in tarot reading too! I recommend local small stores like that for readings if they offer them, they don‚Äôt tend to charge nearly as much\",\"As someone who reads tarot for fun (not a professional psychic here) queen cards tend to symbolize being a leader, and being comfortable in your own skin. You‚Äôve matured into a deeper understanding of yourself, and you‚Äôre someone others look up to (aka YouTube subscribers) they‚Äôre great cards to get in your readings! üíú‚ú® loved this video\",\"I loved that you interpreted the second Pyschic as Maya. It was so wholesome to watch that.\",\"All of my respect goes to the fortune teller that told her to go to the vet instead of making her buy something for $450\",\"I&#39;m not a psychic but I do tarot readings, and I&#39;ve never used it to read someone&#39;s personality, it&#39;s often just &quot;ask me a question&quot; and depending of the question is the spread I do, usually I do a Celtic cross spread and that&#39;s it. Also I don&#39;t charge for the readings, usually it comes from friends that have specific questions, so that&#39;s that.\"],\"comment_count\":\"15235\"}"
echo '{"video_id":"8FDKPMtcZ68","like_count":"203915","@timestamp":"2023-07-17T08:43:10.354808758Z","@version":"1","view_count":"2216821","dislike_count":0,"channel_title":"Jaiden Animations","title":"The Time Psychics Read my Future","comments":["Any psychic that tells you to take your pets to the vet instead of trying to sell you some spirit protection nonsense is a psychic I respect.","Here me out. The psychics saying Jaiden will have 3 kids is foreshadowing her getting a third birb","The whole &quot; you will have 3 kids and live past 80&quot; definitely feels like a script read for someone Jaiden&#39;s gender and age. Either that or they really were psychics.","Wait theory: If all the physics were right about Jaiden having 3 kids but she hates kids, what if they interpreted the wrong thing? What if Jaiden eventually starts calling her birds her babies and maybe gets another pet one day? A lot of people call their pets their babies so it would make sense for the mixup. Jaiden already has 2 birds so what if she gets a 3rd pet to make the fortune come true?","As a reminder, some people consider their pets to be their children! It could mean that at some point Jaiden will get a third bird!","I appreciate Jaiden&#39;s approach to all this.","you could tell psychic 2 was doing it out of pure hobby &amp; passion. a cozy little psychic room in the closet &amp; telling you to go to the vet instead. i love her already.","I appreciate Jaiden&#39;s approach to all this. Despite how weird the experiences must have been, she seems to take it in stride and as respectably as possible.","I‚Äôm so happy to see another story time from Jaiden. I really missed them","I love how Jaiden has upgraded from trying different apples to trying different psychics","it&#39;s good to know how those people get others into their loop. My best friend has the &quot;third eye&quot; apparently and to be honest i don&#39;t believe in psychic and all, but ONCE i lost my cat and she did a reading with all her material...she told me my cat was okay, but she was lost and wouldn&#39;t be found for a long time, like a few years, but that we will see each other again. I took that as her way to comfort me and give me hope and went on with my life. 7 years laters we got a call from an association, they found back our cat, and she is now back home with us. So now every time she tries to guess thing with her third eye, i don&#39;t always believe it but i keep it in the back of my mind and prepare just in case xD<br>Anyways awesome videos with awesome animation as always :) As for the 3 kids xD maybe they&#39;re talking about animals? After all press says we millenial treat our pets like babies :v","The expressions on Jaiden&#39;s face while she was attempting to deal with the 5th psychic were immaculate, well done animation team üòÇ","Takeaways:<br>1. She already has 2 kids (her birds) so maybe having 3 kids means she will get another bird<br>2. Jacob Alpharad is definitely a bearded man who could give Jaiden a business opportunity","Happy to find out Maya Fey is still doing great as a psycic and has Nick working for her. You go girl!","It is SO funny to me that they all predicted kids, a thing Jaiden has no interest in, and then Bobby. Rest in peace sweet egg child. You plus the two birds equals They Were Right","I used to get the best tarot readings of my life for $25 for thirty minutes at a local metaphysical store, didn‚Äôt make me buy a damn thing, would just give me general advice on ‚Äúif you WANTED to get something for this, this stone or this candle may help, but ultimately those are only tools and you can do it yourself‚Äù And the readings were always spot on, offered classes in tarot reading too! I recommend local small stores like that for readings if they offer them, they don‚Äôt tend to charge nearly as much","As someone who reads tarot for fun (not a professional psychic here) queen cards tend to symbolize being a leader, and being comfortable in your own skin. You‚Äôve matured into a deeper understanding of yourself, and you‚Äôre someone others look up to (aka YouTube subscribers) they‚Äôre great cards to get in your readings! üíú‚ú® loved this video","I loved that you interpreted the second Pyschic as Maya. It was so wholesome to watch that.","All of my respect goes to the fortune teller that told her to go to the vet instead of making her buy something for $450","I&#39;m not a psychic but I do tarot readings, and I&#39;ve never used it to read someone&#39;s personality, it&#39;s often just &quot;ask me a question&quot; and depending of the question is the spread I do, usually I do a Celtic cross spread and that&#39;s it. Also I don&#39;t charge for the readings, usually it comes from friends that have specific questions, so that&#39;s that."],"comment_count":"15235"}' | ./kafka-console-producer.sh --bootstrap-server localhost:9092 --topic nome_del_topic

bin/kafka-topics --bootstrap-server localhost:9092 --delete --topic videos
bin/kafka-topics --bootstrap-server localhost:9092 --create --topic videos --partitions 1 --replication-factor 1
